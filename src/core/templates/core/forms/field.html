{#  src/core/templates/core/forms/field.html #}
{# Renders one field with label, help, errors #}
{% load form_extras %}

{# Props:
  field (required)
  label (optional)
  autocomplete (optional)
  placeholder (optional)
  type (optional)
#}

{% with
  base_input_classes="block w-full h-10 rounded-md border border-border bg-background text-foreground placeholder:text-muted-foreground px-3 py-2 text-sm shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ring-offset-background disabled:opacity-50 disabled:cursor-not-allowed"
%}
  <div class="space-y-1.5">
    {% if field.label %}
      <label for="{{ field.id_for_label }}" class="text-sm font-medium">
        {{ label|default:field.label }}
      </label>
    {% endif %}

    {# Start with classes only #}
    {% with attrs="class:"|add:base_input_classes %}
      {# Add type if provided #}
      {% if type %}
        {% with attrs=attrs|add:"; type:"|add:type %}{% endwith %}
      {% endif %}

      {# Add placeholder if provided #}
      {% if placeholder %}
        {% with attrs=attrs|add:"; placeholder:"|add:placeholder %}{% endwith %}
      {% endif %}

      {# Add autocomplete if provided #}
      {% if autocomplete %}
        {% with attrs=attrs|add:"; autocomplete:"|add:autocomplete %}{% endwith %}
      {% endif %}

      {{ field|add_attrs:attrs }}
    {% endwith %}

    {% if field.help_text %}
      <p class="text-xs text-muted-foreground">{{ field.help_text|safe }}</p>
    {% endif %}

    {% if field.errors %}
      <ul class="space-y-0.5">
        {% for err in field.errors %}
          <li class="text-xs text-destructive">{{ err }}</li>
        {% endfor %}
      </ul>
    {% endif %}
  </div>
{% endwith %}
